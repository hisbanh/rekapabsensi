{% comment %}
Pagination Component

Usage:
{% include 'components/_pagination.html' with page_obj=page_obj %}

Expected context variables:
- page_obj: Django Paginator page object
{% endcomment %}

{% if page_obj.has_other_pages %}
<div class="pagination-wrapper">
    <div class="pagination-info">
        Menampilkan {{ page_obj.start_index }}-{{ page_obj.end_index }} dari {{ page_obj.paginator.count }} data
    </div>
    
    <nav aria-label="Page navigation">
        <ul class="pagination pagination-sm mb-0">
            <!-- First Page -->
            <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
                <a class="page-link" href="?page=1{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" aria-label="First">
                    <i class="fas fa-angle-double-left"></i>
                </a>
            </li>
            
            <!-- Previous Page -->
            <li class="page-item {% if not page_obj.has_previous %}disabled{% endif %}">
                <a class="page-link" href="{% if page_obj.has_previous %}?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% else %}#{% endif %}" aria-label="Previous">
                    <i class="fas fa-angle-left"></i>
                </a>
            </li>
            
            <!-- Page Numbers -->
            {% for num in page_obj.paginator.page_range %}
                {% if page_obj.number == num %}
                    <li class="page-item active">
                        <span class="page-link">{{ num }}</span>
                    </li>
                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                    <li class="page-item">
                        <a class="page-link" href="?page={{ num }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">{{ num }}</a>
                    </li>
                {% elif num == page_obj.number|add:'-3' or num == page_obj.number|add:'3' %}
                    <li class="page-item disabled">
                        <span class="page-link">...</span>
                    </li>
                {% endif %}
            {% endfor %}
            
            <!-- Next Page -->
            <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
                <a class="page-link" href="{% if page_obj.has_next %}?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}{% else %}#{% endif %}" aria-label="Next">
                    <i class="fas fa-angle-right"></i>
                </a>
            </li>
            
            <!-- Last Page -->
            <li class="page-item {% if not page_obj.has_next %}disabled{% endif %}">
                <a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}" aria-label="Last">
                    <i class="fas fa-angle-double-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    
    <!-- Per Page Selector -->
    <div class="per-page-selector">
        <select class="form-select form-select-sm" id="perPageSelect" onchange="changePerPage(this.value)">
            <option value="10" {% if request.GET.per_page == '10' or not request.GET.per_page %}selected{% endif %}>10</option>
            <option value="25" {% if request.GET.per_page == '25' %}selected{% endif %}>25</option>
            <option value="50" {% if request.GET.per_page == '50' %}selected{% endif %}>50</option>
            <option value="100" {% if request.GET.per_page == '100' %}selected{% endif %}>100</option>
        </select>
        <span class="per-page-label">per halaman</span>
    </div>
</div>

<style>
.pagination-wrapper {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1rem 1.25rem;
    border-top: 1px solid var(--border-color);
    flex-wrap: wrap;
    gap: 1rem;
}

.pagination-info {
    font-size: 0.85rem;
    color: var(--text-muted);
}

.pagination .page-link {
    border: 1px solid var(--border-color);
    color: var(--text-secondary);
    padding: 0.375rem 0.75rem;
    margin: 0 2px;
    border-radius: 6px;
}

.pagination .page-link:hover {
    background-color: var(--bg-light);
    border-color: var(--primary);
    color: var(--primary);
}

.pagination .page-item.active .page-link {
    background-color: var(--primary);
    border-color: var(--primary);
    color: var(--text-white);
}

.pagination .page-item.disabled .page-link {
    background-color: var(--bg-light);
    color: var(--text-muted);
}

.per-page-selector {
    display: flex;
    align-items: center;
    gap: 0.5rem;
}

.per-page-selector .form-select {
    width: auto;
}

.per-page-label {
    font-size: 0.85rem;
    color: var(--text-muted);
}

@media (max-width: 575.98px) {
    .pagination-wrapper {
        flex-direction: column;
        text-align: center;
    }
    
    .pagination-info {
        order: 2;
    }
    
    .per-page-selector {
        order: 3;
    }
}
</style>

<script>
function changePerPage(value) {
    const url = new URL(window.location.href);
    url.searchParams.set('per_page', value);
    url.searchParams.set('page', '1');
    window.location.href = url.toString();
}
</script>
{% endif %}
